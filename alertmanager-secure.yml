global:
  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email
  smtp_smarthost: '${SMTP_HOST}:${SMTP_PORT}'
  smtp_from: '${SMTP_FROM}'
  smtp_auth_username: '${SMTP_USERNAME}'
  smtp_auth_password: '${SMTP_PASSWORD}'
  smtp_require_tls: true

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
route:
  # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
  group_by: ['alertname', 'cluster', 'service']
  
  # –í—Ä–µ–º—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h
  
  # –ü–æ–ª—É—á–∞—Ç–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  receiver: 'team-notifications'
  
  # –ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
  routes:
  - match:
      severity: critical
    receiver: 'critical-alerts'
    continue: true
  
  - match:
      severity: warning
    receiver: 'warning-alerts'
    continue: true

# –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
receivers:
- name: 'team-notifications'
  email_configs:
  - to: '${TEAM_EMAIL}'
    send_resolved: true
    headers:
      subject: '{{ template "email.subject" . }}'
    html: '{{ template "email.html" . }}'
  
  telegram_configs:
  - bot_token: '${TELEGRAM_BOT_TOKEN}'
    chat_id: '${TELEGRAM_CHAT_ID}'
    parse_mode: 'HTML'
    message: '{{ template "telegram.message" . }}'
    send_resolved: true

- name: 'critical-alerts'
  email_configs:
  - to: '${ADMIN_EMAIL}'
    send_resolved: true
    headers:
      subject: 'üö® CRITICAL: {{ template "email.subject" . }}'
    html: '{{ template "email.critical" . }}'
  
  telegram_configs:
  - bot_token: '${TELEGRAM_BOT_TOKEN}'
    chat_id: '${ADMIN_TELEGRAM_CHAT_ID}'
    parse_mode: 'HTML'
    message: '{{ template "telegram.critical" . }}'
    send_resolved: true

- name: 'warning-alerts'
  email_configs:
  - to: '${TEAM_EMAIL}'
    send_resolved: true
    headers:
      subject: '‚ö†Ô∏è WARNING: {{ template "email.subject" . }}'
    html: '{{ template "email.warning" . }}'
  
  telegram_configs:
  - bot_token: '${TELEGRAM_BOT_TOKEN}'
    chat_id: '${TELEGRAM_CHAT_ID}'
    parse_mode: 'HTML'
    message: '{{ template "telegram.warning" . }}'
    send_resolved: true

# –®–∞–±–ª–æ–Ω—ã –¥–ª—è email
templates:
- '/etc/alertmanager/template/*.tmpl' 